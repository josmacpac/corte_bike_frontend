<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Registro de Usuario</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap CSS -->
  <link 
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" 
    rel="stylesheet"
  >
  <script src="scripts/conf.js"></script>

</head>
<body class="bg-light">

  <div class="container d-flex align-items-center justify-content-center min-vh-100">
    <div class="card p-4 shadow text-center" style="max-width: 500px; width: 100%;">
      
      <!-- Logo -->
      <img 
        src="/assets/Picture.png" 
        alt="Logo del negocio" 
        class="img-fluid mx-auto mb-2" 
        style="max-height: 80px;"
      >

      <h4 class="mb-3">Registro de Usuario</h4>

      <form id="registro-form" class="text-start">
        <div class="mb-2">
          <label for="nombre" class="form-label">Nombre completo</label>
          <input 
            type="text" 
            class="form-control" 
            id="nombre" 
            name="nombre" 
            required
          >
        </div>

        <div class="mb-2">
          <label for="email" class="form-label">Correo electrónico</label>
          <input 
            type="email" 
            class="form-control" 
            id="email" 
            name="email" 
            required
          >
        </div>

        <div class="mb-2">
          <label for="contrasena" class="form-label">Contraseña</label>
          <input 
            type="password" 
            class="form-control" 
            id="contrasena" 
            name="contrasena" 
            required>
        </div>
        <div class="mb-2">
          <label for="contrasena_conf" class="form-label">Confirmar contraseña</label>
          <input 
            type="password" 
            class="form-control" 
            id="contrasena_conf" 
            name="contrasena_conf" 
            required>
        </div>
        <div class="mb-2">
          <label for="telefono" class="form-label">Telefono</label>
          <input 
            type="text" 
            class="form-control" 
            id="telefono" 
            name="telefono" 
            required
          >
          <div id="mensaje" class="text-danger small"></div>

        </div>
        <div class="mb-2">
          <label for="domicilio" class="form-label">Domicilio</label>
          <input 
            type="text" 
            class="form-control" 
            id="domicilio" 
            name="domicilio" 
            required
          >
        </div>
        



        <button type="submit" class="btn btn-success w-100 mt-3">Registrar</button>
    <button type="button" class="btn btn-danger w-100 mt-3" onclick="window.location.href='index.html'">Cancelar</button>

      </form>

      <div id="mensaje" class="mt-2 text-center text-danger"></div>
    </div>
  </div>

  <script>
  document.getElementById("registro-form").addEventListener("submit", function(event){
    event.preventDefault(); // evitar recarga

    const contrasena = document.getElementById("contrasena").value;
    const contrasena_conf = document.getElementById("contrasena_conf").value;
    const mensajeDiv = document.getElementById("mensaje");

    // Validación de contraseña
    if (contrasena !== contrasena_conf) {
      mensajeDiv.textContent = "Las contraseñas no coinciden.";
      return;
    }
    
    mensajeDiv.textContent = ""; // limpiar mensaje de error si todo está bien
    
    const data = {
      nombre: document.getElementById("nombre").value,
      email: document.getElementById("email").value,
      domicilio : document.getElementById("domicilio").value,
      telefono: document.getElementById("telefono").value,
      contrasena: contrasena
    };
    
    console.log(data);
    fetch(`${CONFIG.API_URL}/api/usuarios/registro_cliente`, {
      method: 'POST', 
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(respuesta => {
      console.log('Respuesta del servidor:', respuesta);
      alert("¡Registro exitoso! Serás redirigido a la página de login.");
      window.location.href = "/";
    })
    .catch(error => {
      console.error('Error en el registro:', error);
      alert("Ocurrió un error al registrar. Intenta de nuevo.");
    });
  });
</script>

    
  </body>