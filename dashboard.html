<!DOCTYPE html>
<html lang="es">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8" />
    <title>Dashboard de Citas</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <script src="scripts/conf.js"></script>
    <script src="scripts/globales.js"></script>

    <script src="scripts/auth.js"></script>
    <script src="scripts/cerrar_sesion.js"></script>
  </head>
  <style>
    body {
      padding-top: 70px; /* Ajusta según el alto del navbar */
    }
  </style>
  <body class="bg-light">
    <script>
      verificarAcceso(["admin"]);
    </script>

    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg bg-white shadow-sm fixed-top">
      <div class="container-fluid">
        <!-- Logo y nombre del sistema -->
        <a class="navbar-brand d-flex align-items-center" href="#">
          <img
            src="/assets/Picture.png"
            alt="Logo"
            width="80"
            height="40"
            class="me-2"
          />
        </a>

        <!-- Botón responsive -->
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarTaller"
          aria-controls="navbarTaller"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Enlaces del menú -->
        <div class="collapse navbar-collapse" id="navbarTaller">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link text-secondary active" href="dashboard.html"
                >Dashboard</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link text-secondary" href="reportes.html"
                >Reportes</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link text-secondary" href="conf.html"
                >Configuración</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link text-secondary" href="usuarios.html"
                >Usuarios</a
              >
            </li>
          </ul>
          <!-- Usuario y cerrar sesión -->
          <div class="d-flex align-items-center">
            <i
              class="bi bi-person-circle me-2"
              style="font-size: 1.5rem; color: #6c757d"
            ></i>
            <span id="usuario-actual" class="me-3 text-secondary">Admin</span>
            <a onclick="cerrar_sesion()" class="btn btn-sm btn-outline-danger"
              >Cerrar sesión</a
            >
          </div>
        </div>
      </div>
    </nav>

    <!-- CONTENIDO -->
    <div class="container-fluid mt-4">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="text-secondary">Citas del Taller</h2>
        <button
          class="btn btn-success"
          data-bs-toggle="modal"
          data-bs-target="#modalNuevaCita"
        >
          Agregar Cita
        </button>
      </div>

      <!-- Buscador -->
      <div class="mb-3">
        <label for="buscadorCitas" class="form-label">Busqueda:</label>
        <input
          type="text"
          id="buscadorCitas"
          class="form-control w-50"
          placeholder="Ej. Juan o 00123"
        />
      </div>

      <!-- Filtro de fecha con botón -->
      <div class="mb-3 d-flex align-items-end gap-2">
        <div>
          <label for="filtroFecha" class="form-label">Filtrar por fecha:</label>
          <input type="date" class="form-control" id="filtroFecha" />
        </div>
        <button class="btn btn-outline-primary mb-1" onclick="recargarPagina()">
          Actualizar
        </button>
      </div>

      <!-- Tabla de citas -->
      <div class="table-responsive">
        <table class="table table-bordered table-hover">
          <thead class="table-light">
            <tr>
              <th>Folio</th>
              <th>Fecha Cita</th>
              <th>Cliente</th>
              <th>Servicio</th>
              <th>Fecha Entrega Estimada</th>
              <th>Estado</th>
              <th>Acciones</th>
            </tr>
          </thead>

          <tbody id="tabla-citas"></tbody>
        </table>
      </div>
    </div>

    <!-- MODAL: NUEVA CITA -->
    <div
      class="modal fade"
      id="modalNuevaCita"
      tabindex="-1"
      aria-labelledby="modalNuevaCitaLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <form>
            <div class="modal-header">
              <h5 class="modal-title" id="modalNuevaCitaLabel">
                Agregar Nueva Cita
              </h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Cerrar"
              ></button>
            </div>
            <div class="modal-body">
              <div id="mensaje-error" class="alert alert-danger d-none w-100" role="alert"></div>
            <div id="mensaje-exito" class="alert alert-success d-none w-100" role="alert"></div>
              <div class="mb-3">
  <label>Cliente</label>
  <div class="input-group">
    <input
      type="text"
      id="id-cliente"
      class="form-control"
      required
      placeholder="Ingresa el ID del cliente registrado"
    />
    <button class="btn btn-primary" type="button" id="btn-cargar-cliente">
      Cargar
    </button>
  </div>
  <!-- Aquí se mostrará el nombre del cliente -->
  <div id="nombre-cliente" class="mt-2 text-success"></div>
</div>

              <div class="mb-3">
                <label>Fecha Recibo</label>
                <input type="date" class="form-control" id="fecha-cita" min="" required />
              </div>
              <div class="mb-3">
              <label for="hora" class="form-label">Hora</label>
              <select class="form-select" name="horas-disponibles" id="horas-disponibles" required>
                <option value="">Horarios disponibles</option>
              </select>
            </div>
             
              <div class="mb-3">
                <label for="cantidad_bici" class="form-label"
                  >Cantidad Bicicletas</label
                >
                <input
                  type="number"
                  class="form-control"
                  id="cantidad_bici"
                  min="0"
                  max="10"
                  required
                />
              </div>
                          <!-- Bicicletas: texto + dropdown en la misma línea -->
          <div class="mb-3 d-flex align-items-center">
            <p class="lead mb-0 me-3">Bicicletas:</p>
            <div class="dropdown">
              <button class="btn btn-success dropdown-toggle" type="button" id="dropdownCheckboxMenu" data-bs-toggle="dropdown" aria-expanded="false">
                Selecciona opciones
              </button>
              <ul class="dropdown-menu" aria-labelledby="dropdownCheckboxMenu" style="padding: 10px;">
                <li>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="opcion1" id="chk1" />
                    <label class="form-check-label" for="chk1">Bici 1</label>
                  </div>
                </li>
                <li>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="opcion2" id="chk2" />
                    <label class="form-check-label" for="chk2">Bici 2</label>
                  </div>
                </li>
                <!-- Agrega más opciones aquí -->
              </ul>
            </div>
          </div>
              <div class="mb-3">
                <label for="tipo_mantenimiento" class="form-label"
                  >Servicio</label
                >
                <select
                  class="form-select"
                  id="tipo_mantenimiento"
                  rows="1"
                  required
                >
                  <option selected>Elige tipo de Servicio</option>
                  <option value="101">Mantenimiento</option>
                  <option value="102">Especial</option>
                  <option value="103">Premier</option>
                  <option value="104">Instalacion de Componente menor</option>
                </select>
              </div>
            </div>
            <div class="modal-footer">
              <button type="submit" class="btn btn-success">Guardar</button>
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cancelar
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

   <!-- MODAL: EDITAR CITA -->
<div class="modal fade" id="modalEditarCita" tabindex="-1" aria-labelledby="modalEditarCitaLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form>
        <div class="modal-header">
          <h5 class="modal-title" id="modalEditarCitaLabel">Editar Cita</h5>
          
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <p class="lead">Folio Cita: <span id="folio-cita">1011</span></p>
          </div>
          <div class="mb-3">
            <p class="lead">Cliente: <span id="cliente-nombre">Juan Perez</span></p>
          </div>

          <!-- Bicicletas: texto + dropdown en la misma línea -->
          <div class="mb-3 d-flex align-items-center">
            <p class="lead mb-0 me-3">Bicicletas:</p>
            <div class="dropdown">
              <button class="btn btn-success dropdown-toggle" type="button" id="dropdownCheckboxMenu" data-bs-toggle="dropdown" aria-expanded="false">
                Selecciona opciones
              </button>
              <ul class="dropdown-menu" aria-labelledby="dropdownCheckboxMenu" style="padding: 10px;">
                <li>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="opcion1" id="chk1" />
                    <label class="form-check-label" for="chk1">Bici 1</label>
                  </div>
                </li>
                <li>
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="opcion2" id="chk2" />
                    <label class="form-check-label" for="chk2">Bici 2</label>
                  </div>
                </li>
                <!-- Agrega más opciones aquí -->
              </ul>
            </div>
          </div>

          <div class="mb-3">
            <p class="lead">Fecha Cita: <span id="fecha-cita">13/08/25 10:00 a.m.</span></p>
          </div>
          <div class="mb-3">
            <p class="lead">Fecha Entrada: <span id="fecha-entrada">13/08/25 12:00 a.m.</span></p>
          </div>
          <div class="mb-3">
            <label>Fecha Entrega Estimada</label>
            <input id="fecha-entrega-estimada" type="datetime-local" class="form-control" value="2025-07-30"/>
          </div>
          <div class="mb-3">
            <label>Servicio</label>
            <select class="form-select">
              <option value="101">Mantenimiento</option>
              <option value="102">Especial</option>
              <option value="103">Premier</option>
              <option value="104">Instalacion de componente menor</option>
            </select>
          </div>
          <div class="mb-3">
            <label>Estado</label>
            <select class="form-select">
              <option>Pendiente</option>
              <option selected>En proceso</option>
              <option>Finalizado</option>
              <option>Entregado</option>
              <option>Cancelado</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="detalles-servicio" class="form-label">Detalles del servicio</label>
            <textarea id="detalles-servicio" class="form-control" rows="3" placeholder="Describe aquí los detalles..."></textarea>
          </div>
        </div>

        <!-- Footer con botón Dar Entrada a la izquierda -->
        <div class="modal-footer">
          <button type="button" class="btn btn-success me-auto" id="btn-dar-entrada">
            Registrar Entrada
          </button>
          <button type="submit" class="btn btn-primary">Actualizar</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>

    <!-- BOOTSTRAP JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script></script>

    <script src="scripts/dashboard.js"></script>
  </body>
</html>
